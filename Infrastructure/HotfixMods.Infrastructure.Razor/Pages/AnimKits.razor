@using Infrastructure.Extensions
@using Core.Models.Db2
@using HotfixMods.Infrastructure.Razor.Pages.AnimKitTabs

@if (null == PageTab.Dto)
{
    <TabContentView Data="new List<DashboardModel>()">
    </TabContentView>
}
else
{
    <TabContentEditHeader IsUpdate="false" AddClick_Callback="AddSegment_Click" AddTooltip="Add new segment" Pages="0">
        <ChildContent>
            <MudTabPanel Text="Anim Kit">
                <TabContentEditBody>
                    <AnimKit_Tab Value="((AnimKitDto)PageTab.Dto).AnimKit" ValueLookup="((AnimKitDto?)PageTab.DtoLookup)?.AnimKit" />
                </TabContentEditBody>
            </MudTabPanel>
            @foreach (var (item, index) in ((AnimKitDto)PageTab.Dto).AnimKitSegments.WithIndex())
            {
                <MudTabPanel Text="@($"Segment #{index + 1}")">
                    Segment tab
                </MudTabPanel>
            }
        </ChildContent>
    </TabContentEditHeader>
}

@code {
    [Parameter]
    public PageTab PageTab { get; set; }

    void AddSegment_Click()
    {
        if (PageTab.Dto != null)
            ((AnimKitDto)PageTab.Dto).AnimKitSegments.Add(new AnimKitSegment());
    }
}