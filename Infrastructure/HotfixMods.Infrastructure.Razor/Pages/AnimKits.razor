@using Infrastructure.Extensions
@using Core.Models.Db2

<TabContentEdit DtoName="Test" IsUpdate="false">
    <MudTabs @ref="_mudTabsRef" Elevation="4" Rounded="true" Centered="true" Color="@Color.Primary" PanelClass="mt-n2 mx-2">
        <ChildContent>
            <MudTabPanel Text="Anim Kit">
                <TabContentEditBody>
                    Hello
                </TabContentEditBody>
            </MudTabPanel>
            @foreach (var (item, index) in ((AnimKitDto)PageTab.Dto).AnimKitSegments.WithIndex())
            {
                <MudTabPanel Text="@($"Segment #{index + 1}")">
                    Segment tab
                </MudTabPanel>
            }
        </ChildContent>
        <Header>
            <MudTooltip Text="Add new segment">
                <MudIconButton Icon="@Icons.Filled.Add" Style="color:white" OnClick="AddSegment_Click" />
            </MudTooltip>
        </Header>
    </MudTabs>
</TabContentEdit>


@code {
    [Parameter]
    public PageTab PageTab { get; set; }

    MudTabs? _mudTabsRef;


    void AddSegment_Click()
    {
        ((AnimKitDto)PageTab.Dto).AnimKitSegments.Add(new AnimKitSegment());
    }
}